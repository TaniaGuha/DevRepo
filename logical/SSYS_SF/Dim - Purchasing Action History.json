{
  "logicalTable" : {
    "name" : "Dim - Purchasing Action History",
    "type" : "DIMENSION",
    "primaryKey" : [ "Action History Object Gk" ],
    "logicalColumns" : [ {
      "name" : "Action Code",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.ACTION_CODE" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Action End Date",
      "dataType" : "DATE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : " CAST (%1 AS DATE )",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.ACTION_END_DATE" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Action End Datetime",
      "dataType" : "TIMESTAMP",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.ACTION_END_DATE" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Action History Object Gk",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.ACTION_HISTORY_OBJECT_GK" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Action Start Date",
      "dataType" : "DATE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : " CAST (%1 AS DATE )",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.ACTION_START_DATE" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Action Start Datetime",
      "dataType" : "TIMESTAMP",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.ACTION_START_DATE" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Approval Group Id",
      "dataType" : "DOUBLE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.APPROVAL_GROUP_ID" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Approval Path Id",
      "dataType" : "DOUBLE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.APPROVAL_PATH_ID" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Action Emp Gk",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.APPROVER_EMP_GK" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Action Emp Id",
      "dataType" : "DOUBLE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.APPROVER_EMP_ID" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Action Emp Name",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.APPROVER_EMP_NAME" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Created By",
      "dataType" : "DOUBLE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.CREATED_BY" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Created By Name",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.CREATED_BY_NAME" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Creation Date",
      "dataType" : "TIMESTAMP",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.CREATION_DATE" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Last Update Date",
      "dataType" : "TIMESTAMP",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.LAST_UPDATE_DATE" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Last Updated By",
      "dataType" : "DOUBLE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.LAST_UPDATED_BY" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Last Updated Name",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.LAST_UPDATED_NAME" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Note",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.NOTE" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Object Id",
      "dataType" : "DOUBLE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.OBJECT_ID" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Object Number",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.OBJECT_NUMBER" ]
          }
        } ]
      }
    }, {
      "name" : "Object Sub Type Code",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.OBJECT_SUB_TYPE_CODE" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Object Type Code",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.OBJECT_TYPE_CODE" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Object Type Order",
      "dataType" : "DOUBLE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.OBJECT_TYPE_ORDER" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Offline Code",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.OFFLINE_CODE" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Ou Org Gk",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.OU_ORG_GK" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Ou Org Id",
      "dataType" : "DOUBLE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.OU_ORG_ID" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Po Header Gk",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.PO_HEADER_GK" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Po Header Id",
      "dataType" : "DOUBLE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.PO_HEADER_ID" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Prev Action Code",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.PREV_ACTION_CODE" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Prev Action Date",
      "dataType" : "TIMESTAMP",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.PREV_ACTION_DATE" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Prev Action Emp Gk",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.PREV_ACTION_EMP_GK" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Prev Action Emp Id",
      "dataType" : "DOUBLE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.PREV_ACTION_EMP_ID" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Prev Action Emp Name",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.PREV_ACTION_EMP_NAME" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Release Header Gk",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.RELEASE_HEADER_GK" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Release Header Id",
      "dataType" : "DOUBLE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.RELEASE_HEADER_ID" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Requisition Header Gk",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.REQUISITION_HEADER_GK" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Requisition Header Id",
      "dataType" : "DOUBLE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.REQUISITION_HEADER_ID" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Response Time Day (Cal)",
      "dataType" : "DOUBLE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : " CASE  WHEN %1 < 0 THEN 0 ELSE %1 END ",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.RESPONSE_TIME_DAY" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Response Time Hour",
      "dataType" : "DOUBLE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : " CASE  WHEN %1 < 0 THEN 0 ELSE %1 END ",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.RESPONSE_TIME_HOUR" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Response Time Sec",
      "dataType" : "DOUBLE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : " CASE  WHEN %1 < 0 THEN 0 ELSE %1 END ",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.RESPONSE_TIME_SEC" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Revision Num",
      "dataType" : "DOUBLE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.REVISION_NUM" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Sequence Num",
      "dataType" : "DOUBLE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.SEQUENCE_NUM" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "X Active Ind",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.X_ACTIVE_IND" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "X Etl Insert Dt",
      "dataType" : "TIMESTAMP",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.X_ETL_INSERT_DT" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "X Etl Update Dt",
      "dataType" : "TIMESTAMP",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.X_ETL_UPDATE_DT" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "X Integration Id",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.X_INTEGRATION_ID" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "X Src Create By",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.X_SRC_CREATE_BY" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "X Src Create Dt",
      "dataType" : "TIMESTAMP",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.X_SRC_CREATE_DT" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "X Src Update By",
      "dataType" : "VARCHAR",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.X_SRC_UPDATE_BY" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "X Src Update Dt",
      "dataType" : "TIMESTAMP",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : "%1",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.X_SRC_UPDATE_DT" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Response Time Minute",
      "dataType" : "DOUBLE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : " CASE  WHEN %1 < 0 THEN 0 ELSE %1 END ",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.RESPONSE_TIME_MINUTE" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Response Time Day (Emp WD)",
      "dataType" : "DOUBLE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : " CASE  WHEN  CASE  WHEN %1 = 'REQUISITION' THEN  CASE  WHEN %2 = 'ISR' THEN %3 - %4 - 2 *  FLOOR((%3 - %4) / 7) +  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) < 0 THEN  CASE  WHEN  DAYOFWEEK(%4) = 7 THEN  CASE  WHEN  DAYOFWEEK(%3) = 6 THEN -(2) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(1) + %4 -  CAST (%4 AS DATE ) END  ELSE  CASE  WHEN  DAYOFWEEK(%4) = 6 THEN -(2) + %4 -  CAST (%4 AS DATE ) ELSE -(2) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) = 0 THEN  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %4) < 0 THEN  CASE  WHEN  DAYOFWEEK(%4) IN (6, 7) THEN -(2) - 1 + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(2) END  ELSE  CASE  WHEN  DAYOFWEEK(%4) IN (6, 7) THEN -(1) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  CAST (%3 AS DATE ) -  CAST (%4 AS DATE ) = 0 THEN 0 ELSE -(2) END  END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) > 0 AND  DAYOFWEEK(%3) = 7 THEN -(2) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) > 0 AND  DAYOFWEEK(%3) = 6 THEN -(1) +  CAST (%3 AS DATE ) + 1 - %3 ELSE 0 END  END  END  END  ELSE %3 - %4 - 2 *  FLOOR((%3 - %4) / 7) +  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) < 0 THEN  CASE  WHEN  DAYOFWEEK(%4) = 7 THEN  CASE  WHEN  DAYOFWEEK(%3) = 1 THEN -(2) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %4) >= 0 THEN -(2) + %4 -  CAST (%4 AS DATE ) ELSE -(2) + %4 -  CAST (%4 AS DATE ) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) = 1 THEN -(1) - (%3 -  CAST (%3 AS DATE )) ELSE -(2) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) = 0 THEN  CASE  WHEN  DAYOFWEEK(%4) IN (7, 1) THEN  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %4) >= 0 THEN -(1) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(2) - 1 + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 END  ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %4) < 0 THEN -(2) ELSE  CASE  WHEN  CAST (%3 AS DATE ) -  CAST (%4 AS DATE ) = 0 THEN 0 ELSE -(2) END  END  END  ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %4) >= 0 THEN  CASE  WHEN  DAYOFWEEK(%4) <> 1 AND  DAYOFWEEK(%3) <> 7 THEN 0 ELSE  CASE  WHEN  DAYOFWEEK(%4) = 1 AND  DAYOFWEEK(%3) <> 7 THEN -(1) + %4 -  CAST (%4 AS DATE ) ELSE  CASE  WHEN  DAYOFWEEK(%4) = 1 AND  DAYOFWEEK(%3) = 7 THEN -(2) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(1) +  CAST (%3 AS DATE ) + 1 - %3 END  END  END  ELSE  CASE  WHEN  DAYOFWEEK(%4) = 1 AND  DAYOFWEEK(%3) <> 7 THEN -(1) + %4 -  CAST (%4 AS DATE ) ELSE  CASE  WHEN  DAYOFWEEK(%4) = 1 AND  DAYOFWEEK(%3) = 7 THEN -(2) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  DAYOFWEEK(%4) <> 1 AND  DAYOFWEEK(%3) = 7 THEN -(1) +  CAST (%3 AS DATE ) + 1 - %3 ELSE 0 END  END  END  END  END  END  END  ELSE  CASE  WHEN %2 = 'ISR' THEN %3 - %5 - 2 *  FLOOR((%3 - %5) / 7) +  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) < 0 THEN  CASE  WHEN  DAYOFWEEK(%5) = 7 THEN  CASE  WHEN  DAYOFWEEK(%3) = 6 THEN -(2) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(1) + %5 -  CAST (%5 AS DATE ) END  ELSE  CASE  WHEN  DAYOFWEEK(%5) = 6 THEN -(2) + %5 -  CAST (%5 AS DATE ) ELSE -(2) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) = 0 THEN  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %5) < 0 THEN  CASE  WHEN  DAYOFWEEK(%5) IN (6, 7) THEN -(2) - 1 + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(2) END  ELSE  CASE  WHEN  DAYOFWEEK(%5) IN (6, 7) THEN -(1) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  CAST (%3 AS DATE ) -  CAST (%5 AS DATE ) = 0 THEN 0 ELSE -(2) END  END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) > 0 AND  DAYOFWEEK(%3) = 7 THEN -(2) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) > 0 AND  DAYOFWEEK(%3) = 6 THEN -(1) +  CAST (%3 AS DATE ) + 1 - %3 ELSE 0 END  END  END  END  ELSE %3 - %5 - 2 *  FLOOR((%3 - %5) / 7) +  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) < 0 THEN  CASE  WHEN  DAYOFWEEK(%5) = 7 THEN  CASE  WHEN  DAYOFWEEK(%3) = 1 THEN -(2) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %5) >= 0 THEN -(2) + %5 -  CAST (%5 AS DATE ) ELSE -(2) + %5 -  CAST (%5 AS DATE ) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) = 1 THEN -(1) - (%3 -  CAST (%3 AS DATE )) ELSE -(2) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) = 0 THEN  CASE  WHEN  DAYOFWEEK(%5) IN (7, 1) THEN  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %5) >= 0 THEN -(1) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(2) - 1 + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 END  ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %5) < 0 THEN -(2) ELSE  CASE  WHEN  CAST (%3 AS DATE ) -  CAST (%5 AS DATE ) = 0 THEN 0 ELSE -(2) END  END  END  ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %5) >= 0 THEN  CASE  WHEN  DAYOFWEEK(%5) <> 1 AND  DAYOFWEEK(%3) <> 7 THEN 0 ELSE  CASE  WHEN  DAYOFWEEK(%5) = 1 AND  DAYOFWEEK(%3) <> 7 THEN -(1) + %5 -  CAST (%5 AS DATE ) ELSE  CASE  WHEN  DAYOFWEEK(%5) = 1 AND  DAYOFWEEK(%3) = 7 THEN -(2) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(1) +  CAST (%3 AS DATE ) + 1 - %3 END  END  END  ELSE  CASE  WHEN  DAYOFWEEK(%5) = 1 AND  DAYOFWEEK(%3) <> 7 THEN -(1) + %5 -  CAST (%5 AS DATE ) ELSE  CASE  WHEN  DAYOFWEEK(%5) = 1 AND  DAYOFWEEK(%3) = 7 THEN -(2) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  DAYOFWEEK(%5) <> 1 AND  DAYOFWEEK(%3) = 7 THEN -(1) +  CAST (%3 AS DATE ) + 1 - %3 ELSE 0 END  END  END  END  END  END  END  END  < 0 THEN 0 ELSE  CASE  WHEN %1 = 'REQUISITION' THEN  CASE  WHEN %2 = 'ISR' THEN %3 - %4 - 2 *  FLOOR((%3 - %4) / 7) +  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) < 0 THEN  CASE  WHEN  DAYOFWEEK(%4) = 7 THEN  CASE  WHEN  DAYOFWEEK(%3) = 6 THEN -(2) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(1) + %4 -  CAST (%4 AS DATE ) END  ELSE  CASE  WHEN  DAYOFWEEK(%4) = 6 THEN -(2) + %4 -  CAST (%4 AS DATE ) ELSE -(2) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) = 0 THEN  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %4) < 0 THEN  CASE  WHEN  DAYOFWEEK(%4) IN (6, 7) THEN -(2) - 1 + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(2) END  ELSE  CASE  WHEN  DAYOFWEEK(%4) IN (6, 7) THEN -(1) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  CAST (%3 AS DATE ) -  CAST (%4 AS DATE ) = 0 THEN 0 ELSE -(2) END  END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) > 0 AND  DAYOFWEEK(%3) = 7 THEN -(2) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) > 0 AND  DAYOFWEEK(%3) = 6 THEN -(1) +  CAST (%3 AS DATE ) + 1 - %3 ELSE 0 END  END  END  END  ELSE %3 - %4 - 2 *  FLOOR((%3 - %4) / 7) +  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) < 0 THEN  CASE  WHEN  DAYOFWEEK(%4) = 7 THEN  CASE  WHEN  DAYOFWEEK(%3) = 1 THEN -(2) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %4) >= 0 THEN -(2) + %4 -  CAST (%4 AS DATE ) ELSE -(2) + %4 -  CAST (%4 AS DATE ) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) = 1 THEN -(1) - (%3 -  CAST (%3 AS DATE )) ELSE -(2) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) = 0 THEN  CASE  WHEN  DAYOFWEEK(%4) IN (7, 1) THEN  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %4) >= 0 THEN -(1) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(2) - 1 + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 END  ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %4) < 0 THEN -(2) ELSE  CASE  WHEN  CAST (%3 AS DATE ) -  CAST (%4 AS DATE ) = 0 THEN 0 ELSE -(2) END  END  END  ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %4) >= 0 THEN  CASE  WHEN  DAYOFWEEK(%4) <> 1 AND  DAYOFWEEK(%3) <> 7 THEN 0 ELSE  CASE  WHEN  DAYOFWEEK(%4) = 1 AND  DAYOFWEEK(%3) <> 7 THEN -(1) + %4 -  CAST (%4 AS DATE ) ELSE  CASE  WHEN  DAYOFWEEK(%4) = 1 AND  DAYOFWEEK(%3) = 7 THEN -(2) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(1) +  CAST (%3 AS DATE ) + 1 - %3 END  END  END  ELSE  CASE  WHEN  DAYOFWEEK(%4) = 1 AND  DAYOFWEEK(%3) <> 7 THEN -(1) + %4 -  CAST (%4 AS DATE ) ELSE  CASE  WHEN  DAYOFWEEK(%4) = 1 AND  DAYOFWEEK(%3) = 7 THEN -(2) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  DAYOFWEEK(%4) <> 1 AND  DAYOFWEEK(%3) = 7 THEN -(1) +  CAST (%3 AS DATE ) + 1 - %3 ELSE 0 END  END  END  END  END  END  END  ELSE  CASE  WHEN %2 = 'ISR' THEN %3 - %5 - 2 *  FLOOR((%3 - %5) / 7) +  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) < 0 THEN  CASE  WHEN  DAYOFWEEK(%5) = 7 THEN  CASE  WHEN  DAYOFWEEK(%3) = 6 THEN -(2) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(1) + %5 -  CAST (%5 AS DATE ) END  ELSE  CASE  WHEN  DAYOFWEEK(%5) = 6 THEN -(2) + %5 -  CAST (%5 AS DATE ) ELSE -(2) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) = 0 THEN  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %5) < 0 THEN  CASE  WHEN  DAYOFWEEK(%5) IN (6, 7) THEN -(2) - 1 + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(2) END  ELSE  CASE  WHEN  DAYOFWEEK(%5) IN (6, 7) THEN -(1) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  CAST (%3 AS DATE ) -  CAST (%5 AS DATE ) = 0 THEN 0 ELSE -(2) END  END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) > 0 AND  DAYOFWEEK(%3) = 7 THEN -(2) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) > 0 AND  DAYOFWEEK(%3) = 6 THEN -(1) +  CAST (%3 AS DATE ) + 1 - %3 ELSE 0 END  END  END  END  ELSE %3 - %5 - 2 *  FLOOR((%3 - %5) / 7) +  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) < 0 THEN  CASE  WHEN  DAYOFWEEK(%5) = 7 THEN  CASE  WHEN  DAYOFWEEK(%3) = 1 THEN -(2) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %5) >= 0 THEN -(2) + %5 -  CAST (%5 AS DATE ) ELSE -(2) + %5 -  CAST (%5 AS DATE ) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) = 1 THEN -(1) - (%3 -  CAST (%3 AS DATE )) ELSE -(2) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) = 0 THEN  CASE  WHEN  DAYOFWEEK(%5) IN (7, 1) THEN  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %5) >= 0 THEN -(1) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(2) - 1 + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 END  ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %5) < 0 THEN -(2) ELSE  CASE  WHEN  CAST (%3 AS DATE ) -  CAST (%5 AS DATE ) = 0 THEN 0 ELSE -(2) END  END  END  ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %5) >= 0 THEN  CASE  WHEN  DAYOFWEEK(%5) <> 1 AND  DAYOFWEEK(%3) <> 7 THEN 0 ELSE  CASE  WHEN  DAYOFWEEK(%5) = 1 AND  DAYOFWEEK(%3) <> 7 THEN -(1) + %5 -  CAST (%5 AS DATE ) ELSE  CASE  WHEN  DAYOFWEEK(%5) = 1 AND  DAYOFWEEK(%3) = 7 THEN -(2) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(1) +  CAST (%3 AS DATE ) + 1 - %3 END  END  END  ELSE  CASE  WHEN  DAYOFWEEK(%5) = 1 AND  DAYOFWEEK(%3) <> 7 THEN -(1) + %5 -  CAST (%5 AS DATE ) ELSE  CASE  WHEN  DAYOFWEEK(%5) = 1 AND  DAYOFWEEK(%3) = 7 THEN -(2) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  DAYOFWEEK(%5) <> 1 AND  DAYOFWEEK(%3) = 7 THEN -(1) +  CAST (%3 AS DATE ) + 1 - %3 ELSE 0 END  END  END  END  END  END  END  END  END ",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.OBJECT_TYPE_CODE", "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.APPROVER_EMP_COUNTRY_CODE", "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.ACTION_END_DATE", "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.CREATION_DATE", "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.ACTION_START_DATE" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    }, {
      "name" : "Response Time Day (OU WD)",
      "dataType" : "DOUBLE",
      "writeable" : false,
      "logicalColumnSource" : {
        "derivedFrom" : "PHYSICAL_COLUMNS",
        "physicalMappings" : [ {
          "logicalTableSource" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
          "physicalExpression" : {
            "expressionTemplate" : " CASE  WHEN  CASE  WHEN %1 = 'REQUISITION' THEN  CASE  WHEN %2 = 81 THEN %3 - %4 - 2 *  FLOOR((%3 - %4) / 7) +  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) < 0 THEN  CASE  WHEN  DAYOFWEEK(%4) = 7 THEN  CASE  WHEN  DAYOFWEEK(%3) = 6 THEN -(2) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(1) + %4 -  CAST (%4 AS DATE ) END  ELSE  CASE  WHEN  DAYOFWEEK(%4) = 6 THEN -(2) + %4 -  CAST (%4 AS DATE ) ELSE -(2) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) = 0 THEN  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %4) < 0 THEN  CASE  WHEN  DAYOFWEEK(%4) IN (6, 7) THEN -(2) - 1 + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(2) END  ELSE  CASE  WHEN  DAYOFWEEK(%4) IN (6, 7) THEN -(1) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  CAST (%3 AS DATE ) -  CAST (%4 AS DATE ) = 0 THEN 0 ELSE -(2) END  END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) > 0 AND  DAYOFWEEK(%3) = 7 THEN -(2) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) > 0 AND  DAYOFWEEK(%3) = 6 THEN -(1) +  CAST (%3 AS DATE ) + 1 - %3 ELSE 0 END  END  END  END  ELSE %3 - %4 - 2 *  FLOOR((%3 - %4) / 7) +  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) < 0 THEN  CASE  WHEN  DAYOFWEEK(%4) = 7 THEN  CASE  WHEN  DAYOFWEEK(%3) = 1 THEN -(2) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %4) >= 0 THEN -(2) + %4 -  CAST (%4 AS DATE ) ELSE -(2) + %4 -  CAST (%4 AS DATE ) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) = 1 THEN -(1) - (%3 -  CAST (%3 AS DATE )) ELSE -(2) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) = 0 THEN  CASE  WHEN  DAYOFWEEK(%4) IN (7, 1) THEN  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %4) >= 0 THEN -(1) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(2) - 1 + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 END  ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %4) < 0 THEN -(2) ELSE  CASE  WHEN  CAST (%3 AS DATE ) -  CAST (%4 AS DATE ) = 0 THEN 0 ELSE -(2) END  END  END  ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %4) >= 0 THEN  CASE  WHEN  DAYOFWEEK(%4) <> 1 AND  DAYOFWEEK(%3) <> 7 THEN 0 ELSE  CASE  WHEN  DAYOFWEEK(%4) = 1 AND  DAYOFWEEK(%3) <> 7 THEN -(1) + %4 -  CAST (%4 AS DATE ) ELSE  CASE  WHEN  DAYOFWEEK(%4) = 1 AND  DAYOFWEEK(%3) = 7 THEN -(2) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(1) +  CAST (%3 AS DATE ) + 1 - %3 END  END  END  ELSE  CASE  WHEN  DAYOFWEEK(%4) = 1 AND  DAYOFWEEK(%3) <> 7 THEN -(1) + %4 -  CAST (%4 AS DATE ) ELSE  CASE  WHEN  DAYOFWEEK(%4) = 1 AND  DAYOFWEEK(%3) = 7 THEN -(2) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  DAYOFWEEK(%4) <> 1 AND  DAYOFWEEK(%3) = 7 THEN -(1) +  CAST (%3 AS DATE ) + 1 - %3 ELSE 0 END  END  END  END  END  END  END  ELSE  CASE  WHEN %2 = 81 THEN %3 - %5 - 2 *  FLOOR((%3 - %5) / 7) +  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) < 0 THEN  CASE  WHEN  DAYOFWEEK(%5) = 7 THEN  CASE  WHEN  DAYOFWEEK(%3) = 6 THEN -(2) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(1) + %5 -  CAST (%5 AS DATE ) END  ELSE  CASE  WHEN  DAYOFWEEK(%5) = 6 THEN -(2) + %5 -  CAST (%5 AS DATE ) ELSE -(2) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) = 0 THEN  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %5) < 0 THEN  CASE  WHEN  DAYOFWEEK(%5) IN (6, 7) THEN -(2) - 1 + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(2) END  ELSE  CASE  WHEN  DAYOFWEEK(%5) IN (6, 7) THEN -(1) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  CAST (%3 AS DATE ) -  CAST (%5 AS DATE ) = 0 THEN 0 ELSE -(2) END  END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) > 0 AND  DAYOFWEEK(%3) = 7 THEN -(2) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) > 0 AND  DAYOFWEEK(%3) = 6 THEN -(1) +  CAST (%3 AS DATE ) + 1 - %3 ELSE 0 END  END  END  END  ELSE %3 - %5 - 2 *  FLOOR((%3 - %5) / 7) +  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) < 0 THEN  CASE  WHEN  DAYOFWEEK(%5) = 7 THEN  CASE  WHEN  DAYOFWEEK(%3) = 1 THEN -(2) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %5) >= 0 THEN -(2) + %5 -  CAST (%5 AS DATE ) ELSE -(2) + %5 -  CAST (%5 AS DATE ) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) = 1 THEN -(1) - (%3 -  CAST (%3 AS DATE )) ELSE -(2) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) = 0 THEN  CASE  WHEN  DAYOFWEEK(%5) IN (7, 1) THEN  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %5) >= 0 THEN -(1) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(2) - 1 + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 END  ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %5) < 0 THEN -(2) ELSE  CASE  WHEN  CAST (%3 AS DATE ) -  CAST (%5 AS DATE ) = 0 THEN 0 ELSE -(2) END  END  END  ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %5) >= 0 THEN  CASE  WHEN  DAYOFWEEK(%5) <> 1 AND  DAYOFWEEK(%3) <> 7 THEN 0 ELSE  CASE  WHEN  DAYOFWEEK(%5) = 1 AND  DAYOFWEEK(%3) <> 7 THEN -(1) + %5 -  CAST (%5 AS DATE ) ELSE  CASE  WHEN  DAYOFWEEK(%5) = 1 AND  DAYOFWEEK(%3) = 7 THEN -(2) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(1) +  CAST (%3 AS DATE ) + 1 - %3 END  END  END  ELSE  CASE  WHEN  DAYOFWEEK(%5) = 1 AND  DAYOFWEEK(%3) <> 7 THEN -(1) + %5 -  CAST (%5 AS DATE ) ELSE  CASE  WHEN  DAYOFWEEK(%5) = 1 AND  DAYOFWEEK(%3) = 7 THEN -(2) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  DAYOFWEEK(%5) <> 1 AND  DAYOFWEEK(%3) = 7 THEN -(1) +  CAST (%3 AS DATE ) + 1 - %3 ELSE 0 END  END  END  END  END  END  END  END  < 0 THEN 0 ELSE  CASE  WHEN %1 = 'REQUISITION' THEN  CASE  WHEN %2 = 81 THEN %3 - %4 - 2 *  FLOOR((%3 - %4) / 7) +  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) < 0 THEN  CASE  WHEN  DAYOFWEEK(%4) = 7 THEN  CASE  WHEN  DAYOFWEEK(%3) = 6 THEN -(2) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(1) + %4 -  CAST (%4 AS DATE ) END  ELSE  CASE  WHEN  DAYOFWEEK(%4) = 6 THEN -(2) + %4 -  CAST (%4 AS DATE ) ELSE -(2) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) = 0 THEN  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %4) < 0 THEN  CASE  WHEN  DAYOFWEEK(%4) IN (6, 7) THEN -(2) - 1 + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(2) END  ELSE  CASE  WHEN  DAYOFWEEK(%4) IN (6, 7) THEN -(1) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  CAST (%3 AS DATE ) -  CAST (%4 AS DATE ) = 0 THEN 0 ELSE -(2) END  END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) > 0 AND  DAYOFWEEK(%3) = 7 THEN -(2) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) > 0 AND  DAYOFWEEK(%3) = 6 THEN -(1) +  CAST (%3 AS DATE ) + 1 - %3 ELSE 0 END  END  END  END  ELSE %3 - %4 - 2 *  FLOOR((%3 - %4) / 7) +  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) < 0 THEN  CASE  WHEN  DAYOFWEEK(%4) = 7 THEN  CASE  WHEN  DAYOFWEEK(%3) = 1 THEN -(2) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %4) >= 0 THEN -(2) + %4 -  CAST (%4 AS DATE ) ELSE -(2) + %4 -  CAST (%4 AS DATE ) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) = 1 THEN -(1) - (%3 -  CAST (%3 AS DATE )) ELSE -(2) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%4) = 0 THEN  CASE  WHEN  DAYOFWEEK(%4) IN (7, 1) THEN  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %4) >= 0 THEN -(1) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(2) - 1 + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 END  ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %4) < 0 THEN -(2) ELSE  CASE  WHEN  CAST (%3 AS DATE ) -  CAST (%4 AS DATE ) = 0 THEN 0 ELSE -(2) END  END  END  ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %4) >= 0 THEN  CASE  WHEN  DAYOFWEEK(%4) <> 1 AND  DAYOFWEEK(%3) <> 7 THEN 0 ELSE  CASE  WHEN  DAYOFWEEK(%4) = 1 AND  DAYOFWEEK(%3) <> 7 THEN -(1) + %4 -  CAST (%4 AS DATE ) ELSE  CASE  WHEN  DAYOFWEEK(%4) = 1 AND  DAYOFWEEK(%3) = 7 THEN -(2) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(1) +  CAST (%3 AS DATE ) + 1 - %3 END  END  END  ELSE  CASE  WHEN  DAYOFWEEK(%4) = 1 AND  DAYOFWEEK(%3) <> 7 THEN -(1) + %4 -  CAST (%4 AS DATE ) ELSE  CASE  WHEN  DAYOFWEEK(%4) = 1 AND  DAYOFWEEK(%3) = 7 THEN -(2) + %4 -  CAST (%4 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  DAYOFWEEK(%4) <> 1 AND  DAYOFWEEK(%3) = 7 THEN -(1) +  CAST (%3 AS DATE ) + 1 - %3 ELSE 0 END  END  END  END  END  END  END  ELSE  CASE  WHEN %2 = 81 THEN %3 - %5 - 2 *  FLOOR((%3 - %5) / 7) +  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) < 0 THEN  CASE  WHEN  DAYOFWEEK(%5) = 7 THEN  CASE  WHEN  DAYOFWEEK(%3) = 6 THEN -(2) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(1) + %5 -  CAST (%5 AS DATE ) END  ELSE  CASE  WHEN  DAYOFWEEK(%5) = 6 THEN -(2) + %5 -  CAST (%5 AS DATE ) ELSE -(2) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) = 0 THEN  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %5) < 0 THEN  CASE  WHEN  DAYOFWEEK(%5) IN (6, 7) THEN -(2) - 1 + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(2) END  ELSE  CASE  WHEN  DAYOFWEEK(%5) IN (6, 7) THEN -(1) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  CAST (%3 AS DATE ) -  CAST (%5 AS DATE ) = 0 THEN 0 ELSE -(2) END  END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) > 0 AND  DAYOFWEEK(%3) = 7 THEN -(2) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) > 0 AND  DAYOFWEEK(%3) = 6 THEN -(1) +  CAST (%3 AS DATE ) + 1 - %3 ELSE 0 END  END  END  END  ELSE %3 - %5 - 2 *  FLOOR((%3 - %5) / 7) +  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) < 0 THEN  CASE  WHEN  DAYOFWEEK(%5) = 7 THEN  CASE  WHEN  DAYOFWEEK(%3) = 1 THEN -(2) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %5) >= 0 THEN -(2) + %5 -  CAST (%5 AS DATE ) ELSE -(2) + %5 -  CAST (%5 AS DATE ) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) = 1 THEN -(1) - (%3 -  CAST (%3 AS DATE )) ELSE -(2) END  END  ELSE  CASE  WHEN  DAYOFWEEK(%3) -  DAYOFWEEK(%5) = 0 THEN  CASE  WHEN  DAYOFWEEK(%5) IN (7, 1) THEN  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %5) >= 0 THEN -(1) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(2) - 1 + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 END  ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %5) < 0 THEN -(2) ELSE  CASE  WHEN  CAST (%3 AS DATE ) -  CAST (%5 AS DATE ) = 0 THEN 0 ELSE -(2) END  END  END  ELSE  CASE  WHEN  EXTRACT( HOUR  FROM %3) -  EXTRACT( HOUR  FROM %5) >= 0 THEN  CASE  WHEN  DAYOFWEEK(%5) <> 1 AND  DAYOFWEEK(%3) <> 7 THEN 0 ELSE  CASE  WHEN  DAYOFWEEK(%5) = 1 AND  DAYOFWEEK(%3) <> 7 THEN -(1) + %5 -  CAST (%5 AS DATE ) ELSE  CASE  WHEN  DAYOFWEEK(%5) = 1 AND  DAYOFWEEK(%3) = 7 THEN -(2) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE -(1) +  CAST (%3 AS DATE ) + 1 - %3 END  END  END  ELSE  CASE  WHEN  DAYOFWEEK(%5) = 1 AND  DAYOFWEEK(%3) <> 7 THEN -(1) + %5 -  CAST (%5 AS DATE ) ELSE  CASE  WHEN  DAYOFWEEK(%5) = 1 AND  DAYOFWEEK(%3) = 7 THEN -(2) + %5 -  CAST (%5 AS DATE ) +  CAST (%3 AS DATE ) + 1 - %3 ELSE  CASE  WHEN  DAYOFWEEK(%5) <> 1 AND  DAYOFWEEK(%3) = 7 THEN -(1) +  CAST (%3 AS DATE ) + 1 - %3 ELSE 0 END  END  END  END  END  END  END  END  END ",
            "expressionObjects" : [ "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.OBJECT_TYPE_CODE", "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.OU_ORG_ID", "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.ACTION_END_DATE", "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.CREATION_DATE", "physicalColumn:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History.ACTION_START_DATE" ]
          }
        } ]
      },
      "logicalLevel" : "Dim - Purchasing Action History Detail"
    } ],
    "logicalTableSources" : [ {
      "name" : "FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History",
      "disable" : false,
      "tableMapping" : {
        "tables" : [ "physicalTable:Snowflake.SSYS_DW_30_RC_DB.MARTS.FACT_PO_ACTION_HISTORY_DWH_Dim_Po_Action_History" ]
      },
      "combineWithOtherFragments" : false,
      "enableFragmentSelection" : false,
      "distinctValues" : false
    } ],
    "hierarchyType" : "LEVEL_BASED",
    "levelBasedHierarchy" : {
      "defaultRootLevel" : "Dim - Purchasing Action History Total",
      "ragged" : false,
      "skipped" : false,
      "logicalLevels" : [ {
        "name" : "Dim - Purchasing Action History Total",
        "numberOfElements" : 1,
        "grandTotalLevel" : true,
        "disableAggregateToHigherLevel" : false
      }, {
        "name" : "Dim - Purchasing Action History Detail",
        "numberOfElements" : 2429633,
        "grandTotalLevel" : false,
        "disableAggregateToHigherLevel" : false,
        "primaryKey" : [ "Action History Object Gk" ],
        "displayKey" : "Action History Object Gk"
      } ],
      "logicalHierarchies" : [ {
        "name" : "Purchasing Action History",
        "levels" : [ "Dim - Purchasing Action History Total", "Dim - Purchasing Action History Detail" ]
      } ]
    }
  }
}